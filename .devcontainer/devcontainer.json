{
	"image": "mcr.microsoft.com/devcontainers/base:alpine-3.18",
	"features": {
	  "ghcr.io/devcontainers/features/nix:1": {
		"version": "latest",
		// Needed for flakes & nix-direnv:
		"extraNixConfig": "experimental-features = nix-command flakes,keep-outputs = true,keep-derivations = true"
	  }
	},
	"onCreateCommand": {
	  // Set up global gitignore for direnv.
	  "init-git": "mkdir -p ~/.config/git && printf '.direnv/\\n.envrc\\n' > ~/.config/git/ignore && git config --global core.excludesfile ~/.config/git/ignore",
	  // Install git-crypt for codespace hook?
	  "install-git-crypt": "nix profile install nixpkgs#git-crypt",
	  // Install, set up and allow direnv in workspace.
	  "install-direnv": "nix profile install nixpkgs#direnv nixpkgs#nix-direnv && mkdir -p ~/.config/direnv && echo 'source $HOME/.nix-profile/share/nix-direnv/direnvrc' >> ~/.config/direnv/direnvrc && cp envrc.recommended .envrc && direnv allow",
	  // Add shell hook for direnv
	  "set-direnv-hook": "echo 'eval \"$(direnv hook bash)\"' >> ~/.bashrc"
	},
	"customizations": {
	  "vscode": {
		"extensions": [
		  // Inject direnv variables into VS Code terminals and tasks:
		  "mkhl.direnv",
		  // Support for `.nix` files:
		  "jnoortheen.nix-ide"
		]
	  }
	}
  }